{% extends 'base.html' %}

{% block content %}

<div ng-controller="SetupWeekCtrl" ng-init="init({{week}})" ng-cloak>
    <div ng-show="weekSetup" ng-cloak>
        <p class="alert alert-success">Week {{week}} created!</p>
        <div>
            <a href="/week/{{week}}" class="btn btn-primary btn-lg" role="button">View</a>
        </div>
    </div>
    <div ng-show="!weekSetup">
        <div ng-show="error" class="alert alert-danger">Error saving groups.</div>
        <div class="h2">Creating Week {$ week $}</div>
        <div ng-repeat="group in groups"> 
            <div class="page-header">
                    <div class="h3">Group {$ $index+1 $} <a><small ng-click="removeGroup(group)">X</small></a></div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div>
                        <ol>
                            <li ng-repeat="player in group.players">
                                <span>{$ player.name $}</span>
                                <span ng-if="player.league_points >= 0">- {$ player.league_points $} points</span>
                                <span ng-if="player.direction == 'up'" class="glyphicon glyphicon-arrow-up"></span>
                                <span ng-if="player.direction == 'down'" class="glyphicon glyphicon-arrow-down"></span>
                                <span ng-if="player.direction == 'same'" class="glyphicon glyphicon-minus"></span>
                                <a href="" class="remove" ng-click="removePlayer(group, player)">X</a>
                            </li>
                        <ol>
                        <select ng-model="group.selectedPlayer" ng-options="player.name for player in players">
                            <option value="">Select Player</option>
                        </select>
                    </div>
                    <div>
                        <button type="button" ng-click="addPlayer(group)" class="btn btn-default" ng-disabled="!group.selectedPlayer || group.players.length >= 4">Add Player</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <ul>
                        <li ng-repeat="table in group.tables">
                            <span>{$ table.name $}</span>
                            <a href="" class="remove" ng-click="removeTable(group, table)">X</a>
                        </li>
                    <ul>
                    <select ng-model="group.selectedTable" ng-options="table.name for table in group.availableTables">
                        <option value="">Select Table</option>
                    </select>
                    <br/>
                    <button type="button" ng-click="addTable(group)" class="btn btn-default" ng-disabled="!group.selectedTable || group.tables.length >= 3">Add Table</button>  
                </div>
            </div>
        </div>

        <div class="row">
            <button type="button" ng-click="addGroup()" class="btn btn-default" ng-disabled="players.length==0">Add Group</button>
            <button type="button" ng-click="saveGroups()" class="btn btn-primary">Save</button>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript_src %}
{{ block.super }}
<script src="{{STATIC_URL}}js/src/createWeekController.js"></script>
{% endblock %}